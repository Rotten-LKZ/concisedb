name: Deploy

on:
  push:
    branches:
      - docs-v0

jobs:
  build:
    name: 🍳 Build docs on node ${{ matrix.node_version }} and ${{ matrix.os }}
    runs-on: ubuntu-latest
    strategy:
      matrix:
        os: [ubuntu-latest]
        node_version: [16.x]

    steps:
      - name: 🤔 Checkout
        uses: actions/checkout@v2
      
      - name: 🚚 Install dependencies
        run: |
          npm install

      - name: 🎉 Build docs
        run: |
          npm run docs

      - name: ✨ Clone & Commit
        run: |
          git clone git@github.com:Rotten-LKZ/v0.concisedb.top.git
          cp -r /docs /v0.concisedb.top
          cd v0.concisedb.top
          git config --global user.email Rotten_LKZ@163.com
          git config --global user.name Rotten-LKZ
          git add .
          git commit -m "new docs[updated by bot]" -a

      - name: 📂 Push
        uses: ad-m/github-push-action@master
        with:
          github_token: ${{ secrets.TOKEN }}
          branch: main